openapi: 3.0.0
info:
  title: Waste Sort API
  version: 0.1.0
servers:
  - url: http://127.0.0.1:8000
paths:
  /health:
    get:
      summary: Liveness check
      responses:
        "200":
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok: { type: boolean }
                  service: { type: string }
  /api/classify:
    post:
      summary: Classify an uploaded image of waste
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [file]
              properties:
                file:
                  type: string
                  format: binary
      responses:
        "200":
          description: Classification result
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ClassificationResponse"
              examples:
                example:
                  value:
                    prediction: "plastic"
                    confidence: 0.90
                    topk:
                      - [ "plastic", 0.90 ]
                      - [ "paper",   0.05 ]
                      - [ "glass",   0.03 ]
                      - [ "metal",   0.01 ]
                      - [ "cardboard", 0.01 ]
                      - [ "trash",   0.00 ]
                    tips: "Rinse and place in plastics bin."
                    model_version: "v0-dummy"
        "400":
          description: Bad request (e.g., no file)
components:
  schemas:
    ClassificationResponse:
      type: object
      required: [prediction, confidence, model_version]
      properties:
        prediction:
          type: string
          description: Top-1 predicted class name
        confidence:
          type: number
          format: float
          description: Confidence score for the top-1 class
        topk:
          type: array
          description: Top-k class scores as [name, score] pairs
          items:
            type: array
            minItems: 2
            maxItems: 2
            items:
              oneOf:
                - type: string
                - type: number
        tips:
          type: string
          description: Short action guidance for the predicted class
        model_version:
          type: string
          description: Deployed model identifier
